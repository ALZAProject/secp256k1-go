package secp256k1

import (
	"testing"
	"github.com/stretchr/testify/assert"
)

func TestEcdhInvalidKey(t *testing.T) {
	ctx, err := ContextCreate(ContextSign | ContextVerify)
	if err != nil {
		panic(err)
	}

	alice := []byte{}
	bob := []byte{0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40}

	r, Bob, err := EcPubkeyCreate(ctx, bob)
	spOK(t, r, err)

	r, _, err = Ecdh(ctx, Bob, alice)
	assert.Equal(t, 0, r)
	assert.Error(t, err)
}